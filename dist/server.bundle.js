!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=10)}([function(e,t){e.exports=require("express")},function(e,t){e.exports=require("mongoose")},function(e,t){e.exports=require("passport")},function(e,t){e.exports=require("passport-jwt")},function(e,t){e.exports=require("passport-local")},function(e,t){e.exports=require("body-parser")},function(e,t){e.exports=require("jsonwebtoken")},function(e,t){e.exports=require("cors")},function(e,t){e.exports=require("morgan")},function(e,t){e.exports=require("http")},function(e,t,n){"use strict";n.r(t);var r,o=n(9),u=n.n(o),a=n(0),s=n.n(a),i=n(2),c=n.n(i),l=n(5),f=n.n(l),d=n(8),p=n.n(d),y=n(7),h=n.n(y),b=n(1),v=n.n(b);r={secrets:{jwt:"hipposAreAwesome"},db:{url:"mongodb://mike:password1@ds153763.mlab.com:53763/todos"}};var w=Object.assign({},{port:4e3,testing:{username:"test",password:"password"}},r);v.a.Promise=Promise,v.a.connection.on("error",function(e){return console.error(e)});var m=new v.a.Schema({username:{type:String,required:!0},password:{type:String,required:!0},name:{first:{type:String,required:!0},last:{type:String,required:!0}},profileImage:String,todos:[{type:v.a.Schema.Types.ObjectId,ref:"Todo"}],friends:[{type:v.a.Schema.Types.ObjectId,ref:"User"}],history:[{actionType:{type:String,enum:["CREATED","DELETED","SENT","RECEIVED"]},instigator:{type:v.a.Schema.Types.ObjectId,ref:"User"},todo:{type:v.a.Schema.Types.ObjectId,ref:"Todo"},created:{type:Date,default:Date.now}}]},{id:!1,toJSON:{virtuals:!0}});m.virtual("name.full").get(function(){return this.name.first+" "+this.name.last});var g=v.a.model("User",m),x=function(e,t){return g.findByIdAndUpdate(e,{$push:{history:t}})},S=new v.a.Schema({message:String}),j=v.a.model("Todo",S),k=function(e,t,n,r){return new(n||(n=Promise))(function(o,u){function a(e){try{i(r.next(e))}catch(e){u(e)}}function s(e){try{i(r.throw(e))}catch(e){u(e)}}function i(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}i((r=r.apply(e,t||[])).next())})},T=function(e,t){var n,r,o,u,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return u={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function s(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===u[0]||2===u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}},E=Object(a.Router)();E.get("/",function(e,t){var n=e.user.id;return k(void 0,void 0,void 0,function(){var e,r;return T(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,g.findById(n).populate("todos").select("todos").exec()];case 1:return e=o.sent(),t.status(200).json(e&&e.todos),[3,3];case 2:return r=o.sent(),t.status(500).json(r),[3,3];case 3:return[2]}})})}),E.post("/",function(e,t){var n=e.user.id,r=e.body.message;return k(void 0,void 0,void 0,function(){var e,o;return T(this,function(u){switch(u.label){case 0:return u.trys.push([0,4,,5]),[4,new j({message:r}).save()];case 1:return e=u.sent()._id,[4,g.findByIdAndUpdate(n,{$push:{todos:e}})];case 2:return u.sent(),[4,x(n,{actionType:"CREATED",instigator:n,todo:e})];case 3:return u.sent(),t.sendStatus(200),[3,5];case 4:return o=u.sent(),t.status(500).json(o),[3,5];case 5:return[2]}})})}),E.delete("/:id",function(e,t){var n=e.user,r=e.params;return k(void 0,void 0,void 0,function(){var e;return T(this,function(o){switch(o.label){case 0:return o.trys.push([0,4,,5]),[4,g.findByIdAndUpdate(n.id,{$pullAll:{todos:[r.id]}})];case 1:return o.sent(),[4,j.findByIdAndRemove(r.id)];case 2:return o.sent(),[4,x(n.id,{actionType:"DELETED",instigator:n.id,todo:r.id})];case 3:return o.sent(),t.sendStatus(200),[3,5];case 4:return e=o.sent(),t.status(500).json(e),[3,5];case 5:return[2]}})})}),E.post("/send",function(e,t){var n=e.user.id,r=e.body,o=r.todoId,u=r.recipientId;return k(void 0,void 0,void 0,function(){var e;return T(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),[4,g.findByIdAndUpdate(n,{$pullAll:{todos:[o]}})];case 1:return r.sent(),[4,g.findByIdAndUpdate(u,{$push:{todos:o}})];case 2:return r.sent(),[4,x(n,{actionType:"SENT",instigator:u,todo:o})];case 3:return r.sent(),[4,x(u,{actionType:"RECEIVED",instigator:n,todo:o})];case 4:return r.sent(),t.sendStatus(200),[3,6];case 5:return e=r.sent(),t.status(500).json(e),[3,6];case 6:return[2]}})})});var I=E,O=function(e,t,n,r){return new(n||(n=Promise))(function(o,u){function a(e){try{i(r.next(e))}catch(e){u(e)}}function s(e){try{i(r.throw(e))}catch(e){u(e)}}function i(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}i((r=r.apply(e,t||[])).next())})},A=function(e,t){var n,r,o,u,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return u={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function s(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===u[0]||2===u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}},R=Object(a.Router)();R.get("/",function(e,t){var n=e.user.id;return O(void 0,void 0,void 0,function(){var e,r;return A(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,g.findById(n).select("name profileImage").exec()];case 1:return e=o.sent(),t.status(200).json(e),[3,3];case 2:return r=o.sent(),t.status(500).json(r),[3,3];case 3:return[2]}})})});var P=R,q=function(e,t,n,r){return new(n||(n=Promise))(function(o,u){function a(e){try{i(r.next(e))}catch(e){u(e)}}function s(e){try{i(r.throw(e))}catch(e){u(e)}}function i(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}i((r=r.apply(e,t||[])).next())})},B=function(e,t){var n,r,o,u,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return u={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function s(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===u[0]||2===u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}},_=Object(a.Router)();_.get("/",function(e,t){var n=e.user.id;return q(void 0,void 0,void 0,function(){var e,r;return B(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,g.findById(n).populate({path:"friends",select:"name profileImage"}).select("friends")];case 1:return e=o.sent(),t.status(200).json(e&&e.friends),[3,3];case 2:return r=o.sent(),t.status(500).json(r),[3,3];case 3:return[2]}})})});var D=_,U=function(e,t,n,r){return new(n||(n=Promise))(function(o,u){function a(e){try{i(r.next(e))}catch(e){u(e)}}function s(e){try{i(r.throw(e))}catch(e){u(e)}}function i(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}i((r=r.apply(e,t||[])).next())})},G=function(e,t){var n,r,o,u,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return u={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function s(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===u[0]||2===u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}},L=Object(a.Router)();L.get("/",function(e,t){var n=e.user.id;return U(void 0,void 0,void 0,function(){var e,r;return G(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,g.findById(n).populate("history.instigator","name").select("history").exec()];case 1:return e=o.sent(),t.status(200).json(e&&e.history.reverse()),[3,3];case 2:return r=o.sent(),t.status(500).json(r),[3,3];case 3:return[2]}})})});var M=L,$=Object(a.Router)();$.use("/todos",I),$.use("/user",P),$.use("/friends",D),$.use("/history",M);var C=$,F=function(e,t,n,r){return new(n||(n=Promise))(function(o,u){function a(e){try{i(r.next(e))}catch(e){u(e)}}function s(e){try{i(r.throw(e))}catch(e){u(e)}}function i(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}i((r=r.apply(e,t||[])).next())})},N=function(e,t){var n,r,o,u,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return u={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function s(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===u[0]||2===u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}},V=Object(a.Router)();V.post("/",function(e,t){var n=e.body.username;return F(void 0,void 0,void 0,function(){var e,r;return N(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,new g({username:n+"_friend",password:"password",name:{first:"Han",last:"Solo"},profileImage:"https://i.imgur.com/X3MfY8T.png"}).save()];case 1:return e=o.sent()._id,[4,new g({username:n,password:"password",name:{first:"Luke",last:"Skywalker"},profileImage:"https://i.imgur.com/gwy9tVn.png",friends:[e]}).save()];case 2:return o.sent(),t.sendStatus(200),[3,4];case 3:return r=o.sent(),t.status(500).json(r),[3,4];case 4:return[2]}})})}),V.delete("/:username",function(e,t){var n=e.params.username;return F(void 0,void 0,void 0,function(){var e,r,o,u;return N(this,function(a){switch(a.label){case 0:return a.trys.push([0,7,,8]),[4,g.findOneAndRemove({username:n}).select("todos").exec()];case 1:return(e=a.sent())?(o=e.todos,[4,Promise.all(o.map(function(e){return j.findByIdAndRemove(e).exec()}))]):[3,3];case 2:a.sent(),a.label=3;case 3:return[4,g.findOneAndRemove({username:n+"_friend"}).select("todos").exec()];case 4:return(r=a.sent())?(o=r.todos,[4,Promise.all(o.map(function(e){return j.findByIdAndRemove(e).exec()}))]):[3,6];case 5:a.sent(),a.label=6;case 6:return t.sendStatus(200),[3,8];case 7:return u=a.sent(),t.status(500).json(u),[3,8];case 8:return[2]}})})});var H=V,J=Object(a.Router)();J.use("/user",H);var z=J,K=n(6),X=n.n(K),Y=Object(a.Router)();Y.post("/",function(e,t){c.a.authenticate("local",{session:!1},function(e,n,r){e?t.sendStatus(500):n?t.json({token:X.a.sign(n,w.secrets.jwt)}):(t.status(401),t.json(r))})(e,t)});var Q=Y,W=n(4),Z=n(3),ee=function(e,t,n,r){return new(n||(n=Promise))(function(o,u){function a(e){try{i(r.next(e))}catch(e){u(e)}}function s(e){try{i(r.throw(e))}catch(e){u(e)}}function i(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}i((r=r.apply(e,t||[])).next())})},te=function(e,t){var n,r,o,u,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return u={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function s(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===u[0]||2===u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}},ne=function(e,t,n){return ee(void 0,void 0,void 0,function(){var r;return te(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,g.findOne({username:e}).select("password").exec()];case 1:return(r=o.sent())?r.password!==t?n(null,!1,{message:"Incorrect password"}):n(null,{id:r._id}):n(null,!1,{message:"Unknown username"}),[3,3];case 2:return o.sent(),n(new Error),[3,3];case 3:return[2]}})})},re=function(e,t,n,r){return new(n||(n=Promise))(function(o,u){function a(e){try{i(r.next(e))}catch(e){u(e)}}function s(e){try{i(r.throw(e))}catch(e){u(e)}}function i(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}i((r=r.apply(e,t||[])).next())})},oe=function(e,t){var n,r,o,u,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return u={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function s(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===u[0]||2===u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}},ue=function(e,t){return re(void 0,void 0,void 0,function(){var n;return oe(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,g.findById(e.id)];case 1:return n=r.sent(),t(null,!!n&&e),[3,3];case 2:return r.sent(),t(null,!1),[3,3];case 3:return[2]}})})},ae=function(e,t,n,r){return new(n||(n=Promise))(function(o,u){function a(e){try{i(r.next(e))}catch(e){u(e)}}function s(e){try{i(r.throw(e))}catch(e){u(e)}}function i(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}i((r=r.apply(e,t||[])).next())})},se=function(e,t){var n,r,o,u,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return u={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function s(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===u[0]||2===u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}},ie=function(e,t,n){return ae(void 0,void 0,void 0,function(){return se(this,function(r){try{e!==w.testing.username||t!==w.testing.password?n(null,!1,{message:"Incorrect credentials"}):n(null,{id:"someTestId"})}catch(e){n(new Error)}return[2]})})};c.a.use(new W.Strategy(ne)),c.a.use(new Z.Strategy({jwtFromRequest:Z.ExtractJwt.fromAuthHeaderAsBearerToken(),secretOrKey:w.secrets.jwt},ue)),c.a.use("testingLocal",new W.Strategy({usernameField:"u",passwordField:"p"},ie)),v.a.connect(w.db.url);var ce=s()();ce.use(h()()),ce.use(f.a.urlencoded({extended:!0})),ce.use(f.a.json()),ce.use(c.a.initialize()),ce.use(p()("dev")),ce.use("/api",c.a.authenticate("jwt",{session:!1}),C),ce.use("/testing",c.a.authenticate("testingLocal",{session:!1}),z),ce.use("/signin",Q);var le=ce,fe=u.a.createServer(le);fe.listen(w.port,function(){console.log("Server listening on port "+fe.address().port)})}]);